@usedefault

h2. How to use LXC

h3. Intro

{{include:_DownloadLXCBase}}

h3. jsmachine

is the main tool to interact with lxc 

{{code:
# jsmachine --help
usage: jsmachine [-h] [-n NAME] [-m BNAME] [-b BASE] [-p PASSWD] [-r PREFIX]
                 [-k KEY] [-c CMD] [-a PUBIP] [-g GW] [--start]
                 
                 {ps,new,list,destroyall,destroy,cmd,rdp,ssh,start,stop,restart,getip,exportTGZ,importTGZ,exportR,importR}

positional arguments:
  {ps,new,list,destroyall,destroy,cmd,rdp,ssh,start,stop,restart,getip,exportTGZ,importTGZ,exportR,importR}
                        Command to perform

optional arguments:
  -h, --help            show this help message and exit
  -n NAME, --name NAME  machine name
  -m BNAME, --bname BNAME
                        name of backup (used for import/export)
  -b BASE, --base BASE  base to clone from
  -p PASSWD, --passwd PASSWD
                        password for machine
  -r PREFIX, --prefix PREFIX
                        prefix
  -k KEY, --key KEY     key for syncing
  -c CMD, --cmd CMD     cmd to execute
  -a PUBIP, --pubip PUBIP
                        set pub ip addr of machine (192.168.1.207/24)
  -g GW, --gw GW        set ip gateway of machine (192.168.1.1)
  --start               start after creation
}}

h3. create your first machine

create a machine to start working with
{{code:
jsmachine new -n test -b base -a 192.168.1.31/24 -g 192.168.1.1 --start
}}

-a 192.168.1.31 is from existing range on my network
-g is the gateway
make sure the netmask is properly done

the --start will try to ssh the just created lxc

h3. list machines

{{code:
# jsmachine list
## running:
  machine: test                      10.10.253.4
## stopped:
  machine: base                      10.10.253.7
  machine: sentry                    10.10.253.3
}}

h3. remote execute something on machine(s)

{{code:
jsexec -r test -x "ls /" -s
}}

-s will do it synchronously

{{code:
jsexec -r test,test3 -x "ls /"
}}

will execute both in parallel & show result


